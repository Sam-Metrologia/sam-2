{% extends 'base.html' %}
{% load static %}

{% block extra_head %}
<style>
    .terminos-container {
        max-width: 1200px;
        margin: 2rem auto;
        padding: 0 1rem;
    }

    .terminos-header {
        text-align: center;
        margin-bottom: 2rem;
        padding: 2rem;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 0.5rem;
    }

    .terminos-header h1 {
        font-size: 2rem;
        font-weight: bold;
        margin-bottom: 0.5rem;
    }

    .terminos-header p {
        font-size: 1.1rem;
        opacity: 0.9;
    }

    .pdf-viewer {
        width: 100%;
        height: 600px;
        border: 2px solid #e2e8f0;
        border-radius: 0.5rem;
        margin-bottom: 2rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .acceptance-box {
        background-color: #f7fafc;
        border: 2px solid #e2e8f0;
        border-radius: 0.5rem;
        padding: 2rem;
        margin-bottom: 2rem;
    }

    .checkbox-container {
        display: flex;
        align-items: center;
        margin-bottom: 1.5rem;
        padding: 1rem;
        background-color: white;
        border-radius: 0.375rem;
        border: 1px solid #cbd5e0;
    }

    .checkbox-container input[type="checkbox"] {
        width: 20px;
        height: 20px;
        margin-right: 1rem;
        cursor: pointer;
    }

    .checkbox-container label {
        font-size: 1.1rem;
        font-weight: 500;
        cursor: pointer;
        margin: 0;
    }

    .btn-container {
        display: flex;
        justify-content: center;
        gap: 1rem;
    }

    .btn-accept {
        background-color: #48bb78;
        color: white;
        padding: 0.75rem 2rem;
        font-size: 1.1rem;
        font-weight: bold;
        border: none;
        border-radius: 0.375rem;
        cursor: pointer;
        transition: background-color 0.2s;
    }

    .btn-accept:hover:not(:disabled) {
        background-color: #38a169;
    }

    .btn-accept:disabled {
        background-color: #cbd5e0;
        cursor: not-allowed;
    }

    .btn-reject {
        background-color: #f56565;
        color: white;
        padding: 0.75rem 2rem;
        font-size: 1.1rem;
        font-weight: bold;
        border: none;
        border-radius: 0.375rem;
        cursor: pointer;
        transition: background-color 0.2s;
    }

    .btn-reject:hover {
        background-color: #e53e3e;
    }

    .info-notice {
        background-color: #bee3f8;
        border-left: 4px solid #3182ce;
        padding: 1rem;
        margin-bottom: 1.5rem;
        border-radius: 0.375rem;
    }

    .info-notice p {
        margin: 0;
        color: #2c5282;
        font-weight: 500;
    }

    .version-badge {
        display: inline-block;
        background-color: #667eea;
        color: white;
        padding: 0.25rem 0.75rem;
        border-radius: 1rem;
        font-size: 0.9rem;
        font-weight: bold;
    }

    .btn-view {
        padding: 0.5rem 1rem;
        font-size: 0.95rem;
        font-weight: 500;
        border: 2px solid #cbd5e0;
        border-radius: 0.375rem;
        background-color: white;
        color: #2d3748;
        cursor: pointer;
        transition: all 0.2s;
    }

    .btn-view:hover {
        background-color: #f7fafc;
        border-color: #667eea;
    }

    .btn-view.active {
        background-color: #667eea;
        color: white;
        border-color: #667eea;
    }
</style>
{% endblock %}

{% block content %}
<div class="terminos-container">
    <!-- Header -->
    <div class="terminos-header">
        <h1>T√©rminos y Condiciones de Uso</h1>
        <p>Plataforma SAM Metrolog√≠a <span class="version-badge">Versi√≥n {{ terminos.version }}</span></p>
        <p style="font-size: 0.95rem; margin-top: 0.5rem;">Vigente desde: {{ terminos.fecha_vigencia|date:"Y-m-d" }}</p>
    </div>

    <!-- Mensaje informativo -->
    <div class="info-notice">
        <p><strong>Importante:</strong> Debes leer y aceptar los t√©rminos y condiciones para continuar usando SAM Metrolog√≠a.</p>
    </div>

    <!-- Aviso sobre contrato digital -->
    <div style="background-color: #e3f2fd; border-left: 4px solid #2196f3; padding: 1rem; margin-bottom: 1rem; border-radius: 0.375rem;">
        <p style="margin: 0; color: #1565c0; font-weight: 500;">
            üìú <strong>Contrato Digital:</strong> A continuaci√≥n encontrar√°s el contrato completo de uso de SAM Metrolog√≠a.
            Tu aceptaci√≥n electr√≥nica tiene plena validez legal conforme a la Ley 527 de 1999.
        </p>
    </div>

    <!-- Contenido del contrato (√∫nica visualizaci√≥n) -->
    <div style="margin-bottom: 2rem;">
        <h3 style="margin-bottom: 1rem; color: #2d3748;">üìú T√©rminos y Condiciones de Uso</h3>
        <div style="background-color: white; padding: 2rem; border-radius: 0.5rem; border: 2px solid #e2e8f0; max-height: 600px; overflow-y: auto; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
            {{ terminos.contenido_html|safe }}
        </div>
    </div>

    <!-- Formulario de aceptaci√≥n -->
    <form method="post" id="formTerminos">
        {% csrf_token %}

        <div class="acceptance-box">
            <h3 style="margin-bottom: 1rem; color: #2d3748;">Aceptaci√≥n de T√©rminos</h3>

            <div class="checkbox-container">
                <input
                    type="checkbox"
                    id="acepta_terminos"
                    name="acepta_terminos"
                    required>
                <label for="acepta_terminos">
                    He le√≠do, comprendido y acepto los T√©rminos y Condiciones de Uso de SAM Metrolog√≠a
                </label>
            </div>

            <div class="btn-container">
                <button type="submit" class="btn-accept" id="btnAceptar" disabled>
                    ‚úì Aceptar y Continuar
                </button>
            </div>
        </div>
    </form>

    <!-- Formulario de rechazo (oculto) -->
    <form method="post" action="{% url 'core:rechazar_terminos' %}" id="formRechazar" style="display: none;">
        {% csrf_token %}
    </form>

    <div style="text-align: center; margin-top: 1rem;">
        <button type="button" class="btn-reject" onclick="confirmarRechazo()">
            ‚úï Rechazar y Cerrar Sesi√≥n
        </button>
    </div>

    <!-- Footer informativo -->
    <div style="margin-top: 2rem; padding: 1.5rem; background-color: #f7fafc; border-radius: 0.5rem; text-align: center;">
        <p style="margin: 0; color: #718096; font-size: 0.9rem;">
            <strong>SAS METROLOGIA S.A.S</strong><br>
            NIT: 901.853.117-1<br>
            Bogot√° D.C, Colombia
        </p>
    </div>
</div>

<script>
    // Habilitar bot√≥n de aceptar solo cuando marque el checkbox
    document.getElementById('acepta_terminos').addEventListener('change', function() {
        document.getElementById('btnAceptar').disabled = !this.checked;
    });

    // Confirmar rechazo
    function confirmarRechazo() {
        if (confirm('¬øEst√°s seguro de que deseas rechazar los t√©rminos? Se cerrar√° tu sesi√≥n y no podr√°s usar SAM Metrolog√≠a.')) {
            document.getElementById('formRechazar').submit();
        }
    }

    // Prevenir env√≠o si no est√° marcado el checkbox
    document.getElementById('formTerminos').addEventListener('submit', function(e) {
        if (!document.getElementById('acepta_terminos').checked) {
            e.preventDefault();
            alert('Debes aceptar los t√©rminos y condiciones para continuar.');
        }
    });
</script>
{% endblock %}
