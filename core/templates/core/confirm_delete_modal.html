{# core/templates/core/confirm_delete_modal.html #}

<div id="delete-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white delete-modal-content">
        <div class="mt-3 text-center">
            <h3 class="text-lg leading-6 font-medium text-gray-900">Confirmar Eliminación</h3>
            <div class="mt-2 px-7 py-3">
                <p class="text-sm text-gray-500">
                    Estás a punto de eliminar <span id="object-name-in-modal" class="font-bold"></span>. Esta acción es irreversible.
                    Para confirmar, por favor introduce tu contraseña de superusuario:
                </p>
                <form method="post" id="delete-form">
                    {% csrf_token %}
                    <div class="mt-4">
                        <label for="password-confirm" class="sr-only">Contraseña</label>
                        <input type="password" name="password_confirm" id="password-confirm"
                               class="appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm"
                               placeholder="Contraseña de Superusuario" required>
                    </div>
                    <div class="items-center px-4 py-3 mt-4">
                        <button type="submit"
                                class="px-4 py-2 bg-red-600 text-white text-base font-medium rounded-md w-full shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 transition duration-300 ease-in-out">
                            Eliminar
                        </button>
                        <button type="button" onclick="closeDeleteModal()"
                                class="mt-3 px-4 py-2 bg-gray-300 text-gray-800 text-base font-medium rounded-md w-full shadow-sm hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500 transition duration-300 ease-in-out">
                            Cancelar
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    // Función genérica para abrir el modal de eliminación
    function openDeleteModal(objectId, objectName, deleteUrlPattern) {
        const modal = document.getElementById('delete-modal');
        const form = modal.querySelector('#delete-form');
        
        // Actualiza el texto del modal
        modal.querySelector('#object-name-in-modal').textContent = `"${objectName}"`;
        
        // Actualiza la acción del formulario
        // Reemplaza el marcador de posición con el ID real
        form.action = deleteUrlPattern.replace('0', objectId); 
        
        modal.classList.remove('hidden');
    }

    function closeDeleteModal() {
        document.getElementById('delete-modal').classList.add('hidden');
        document.getElementById('password-confirm').value = ''; // Limpiar campo de contraseña
    }

    // Cerrar el modal al hacer clic fuera de él
    window.onclick = function(event) {
        const modal = document.getElementById('delete-modal');
        if (event.target == modal) {
            modal.classList.add('hidden');
            document.getElementById('password-confirm').value = ''; // Limpiar campo de contraseña
        }
    }
</script>
